<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
	"-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="_4.mapper.CouponMapper">
	<insert id="empCouponRegistInsert" parameterType="couponDTO">
		insert into empCoupon (COUPON_NUM, COUPON_NAME, DISCOUNT_TYPE, EXPIRATION_DATE
		, DISCOUNT_RATE, COUPON_NOTE, EMP_NUM)
		values(#{couponNum}, #{couponName}, #{discountType}, #{expirationDate}
		, #{discountRate}, #{couponNote}, #{empNum} )
	</insert>
	<insert id="ownerCouponRegistInsert" parameterType="couponDTO">
		insert into ownerCoupon (COUPON_NUM, COUPON_NAME, DISCOUNT_TYPE, EXPIRATION_DATE
		, DISCOUNT_RATE, COUPON_NOTE, OWNER_NUM)
		values(#{couponNum}, #{couponName}, #{discountType}, #{expirationDate}
		, #{discountRate}, #{couponNote}, #{ownerNum} )
	</insert>
	<select id="empCouponSelectAll">
		select * from empCoupon
		where emp_num = #{userNum}
	</select>
	<select id="ownerCouponSelectAll">
		select * from ownerCoupon
		where owner_num = #{userNum}
	</select>
	<select id="couponSelectOne" parameterType="string" resultType="couponDTO">
		select * from empcoupon 
		where coupon_num = #{couponNum}
		union
		select * from ownercoupon
		where coupon_num = #{couponNum}
	</select>
	<update id="empCouponUpdate" parameterType="couponDTO">
		update empcoupon set COUPON_NAME = #{couponName}
		, DISCOUNT_TYPE = #{discountType}, EXPIRATION_DATE = #{expirationDate}
		, DISCOUNT_RATE = #{discountRate}, COUPON_NOTE = #{couponNote}
		, EMP_NUM = #{empNum}
		where EMP_NUM = #{empNum} and COUPON_NUM = #{couponNum}
	</update>
	<update id="ownerCouponUpdate" parameterType="couponDTO">
		update ownerCoupon set COUPON_NAME = #{couponName}
		, DISCOUNT_TYPE = #{discountType}, EXPIRATION_DATE = #{expirationDate}
		, DISCOUNT_RATE = #{discountRate}, COUPON_NOTE = #{couponNote}
		, OWNER_NUM = #{ownerNum}
		where OWNER_NUM = #{ownerNum} and COUPON_NUM = #{couponNum}
	</update> 
	<delete id="empCouponDelete" parameterType="string">
		delete from empCoupon 
		where EMP_NUM = #{userNum} and COUPON_NUM = #{couponNum}
	</delete>
	<delete id="ownerCouponDelete" parameterType="string">
		delete from ownerCoupon 
		where OWNER_NUM = #{userNum} and COUPON_NUM = #{couponNum}
	</delete>
</mapper>